!function(window,document){function setValue(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch(i){}}function getValue(e){var t="";try{t=localStorage.getItem(e)}catch(i){}return t}function setup(){var version=1,location=window.location,isMobile=window.matchMedia("(max-device-width: 700px)").matches,deviceId=getValue(window.iticks.clientId+".iticksId");function createDiv(e){var t=document.createElement("div");if(e)for(var i in e)t.style[i]=e[i];return document.body.appendChild(t),t}function createImageModal(){var e=createDiv({}),t=document.createElement("div");t.className="iticks-modal",t.style.display="none";var i=document.createElement("span");i.className="iticks-modal-close",i.innerHTML="&times;",i.setAttribute("title","Close"),t.appendChild(i);var n=document.createElement("img");n.className="iticks-modal-img iticks-modal-content",t.appendChild(n),i.onclick=function(){t.style.display="none"},e.appendChild(t)}var styleElem=document.head.appendChild(document.createElement("style"));styleElem.innerHTML='.iticks-pop-button{position:fixed;z-index:2147483646;border:0;box-shadow: 0 0px 20px 0 rgba(0, 0, 0, .25);;transition:all .4s, bottom .8s ease-in-out;cursor:pointer;animation-duration:.2s;width:64px;height:64px;border-radius:32px;top:auto !important;}.iticks-badge-container{background: #ea4141;position: absolute;top: -3px;height: 17px;width: 17px;border-radius: 100px;box-shadow: 0 1px 5px 0 rgba(0, 0, 0, .5);}.iticks-badge-num{font-size:11px;line-height:17px;color:#fff;text-align: center;font-weight: bold;font-family: sans-serif;}.agent-img{width:64px !important;height:64px !important;margin:0px !important;border-radius:50%;}.iticks-close-btn{visibility:hidden;text-align:right;}.iticks-close-btn span{cursor:pointer;padding: 0px 5px;display:inline-block;}.iticks-close-btn .close-icon{width: 16px;height: 16px;fill: #666666;}.iticks-notif-msg:hover .iticks-close-btn{visibility:visible;}.iticks-notif-msg {position: fixed;max-width: 250px;z-index:2147483646;transition:all .4s, bottom .8s ease-in-out;animation-duration:.2s;}.iticks-last-msg{position: relative;background-color: #fff;border-radius: 5px;box-shadow: 1px 2px 9px 0px rgba(0,0,0,.4);cursor: pointer;white-space: pre-wrap;max-width: 250px;padding: 10px 15px;}.iticks-last-msg::after {z-index: 0;content: "";position: absolute;width: 8px;height: 8px;background: #fff;transform: rotate(45deg);bottom: 15px;}.notif-msg > div {max-height: 51px;line-height: 17px;overflow: hidden;word-break: break-all;}.notif-msg > div::before {content: "...";position: absolute;right: 6px;bottom: 9px;}.notif-msg > div::after {content:"";position: absolute;right: 4px;width: 1em;height: 1em;margin-top: 0.2em;background: #FFF;}.iticks-last-container{z-index:2147483646;color:#000;}.iticks-last-container p{margin:0;}.iticks-badge-container{display:none;}.iticks-frame-container{height:100%;transition: all .4s,bottom .8s ease-in-out !important;top:auto !important;}.iticks-hidden{top:auto !important;bottom:-100% !important}@media only screen and (max-device-width:700px) {body.iticks-open{overflow:auto;width:100%;height:100%;position:fixed !important;}.iticks-close-btn{visibility:visible;}.iticks-frame-container{width:100% !important;height:100% !important;max-height:unset !important;right:0 !important;left: 0 !important}}.iticks-modal-img{ border-radius: 5px; cursor: pointer; transition: .3s }.iticks-modal{ display: none; position: fixed; z-index: 2147483648; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color:#000; background-color: rgba(0, 0, 0, .9);justify-content: center;align-items: center; }.iticks-modal-content{ margin: auto; display: block; width: auto; max-height: 80%;}.iticks-modal-img{-webkit-animation-name: zoom;-webkit-animation-duration: .6s; animation-name: zoom; animation-duration: .6s; cursor: pointer; }@-webkit-keyframes zoom{ from{-webkit-transform: scale(0) } to{-webkit-transform: scale(1) } }@keyframes zoom{ from{ transform: scale(0) } to{ transform: scale(1) } }.iticks-modal-close{ position: absolute; top: 15px; right: 35px; color:#f1f1f1; font-size: 40px; font-weight: 700; transition: .3s; cursor: pointer; }.iticks-modal-close: focus,.iticks-modal-close: hover{ color:#bbb; text-decoration: none; cursor: pointer } @media only screen and(max-width: 700px){.iticks-modal-content{ width: 100%} } ';var buttonDiv=createDiv({});buttonDiv.innerHTML='<div class="iticks-pop-button"><img alt="chat-icon" class="chat-icon" style="width:32px;height:32px;margin:16px;" src="data:,"/><div class="iticks-badge-container"><div class="iticks-badge-num">0</div></div></div><div class="iticks-last-container"><div class="iticks-notif-msg iticks-hidden"><div class="iticks-close-btn"><span><svg class="close-icon" viewBox="0 0 512 512"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"></path></svg></span></div><div class="iticks-last-msg"></div></div></div>',createImageModal();var containerDiv=createDiv({position:"fixed",display:"block",background:"transparent","z-index":"2147483646","box-shadow":"0 0 15px 0 rgba(0, 0, 0, .15)"});containerDiv.className="iticks-frame-container",containerDiv.innerHTML='<iframe title="chatbot" src="'+window.iticks.host+"/widgets/engage/"+window.iticks.clientId+"?ref="+encodeURIComponent(document.referrer)+"&landing="+encodeURIComponent(window.location.href)+"&v=1&cudId="+encodeURIComponent(deviceId)+'" style="border:0;width:100%;height:100%;" allowfullscreen>Loading...</iframe>';var chatFrame=containerDiv.querySelector("iframe"),lastMsgContainer=buttonDiv.querySelector(".iticks-last-container"),lastMsg=lastMsgContainer.querySelector(".iticks-notif-msg"),badgeContainer=buttonDiv.querySelector(".iticks-badge-container"),unreadCounter=buttonDiv.querySelector(".iticks-badge-num"),unreadMessage=buttonDiv.querySelector(".iticks-last-msg"),popbutton=buttonDiv.querySelector(".iticks-pop-button"),chatIcon=buttonDiv.querySelector(".chat-icon"),closeBtn=buttonDiv.querySelector(".iticks-close-btn>span"),lastState=null;function togglePageScroll(e){if(e){var t="top: -"+(window.scrollY||window.pageYOffset)+"px !important";document.all?document.body.style.setAttribute("cssText",t):document.body.setAttribute("style",t),document.body.classList.add("iticks-open")}else{document.body.classList.remove("iticks-open");var i=document.body.style.top;document.body.style.top="",window.scrollBy(0,-1*parseInt(i||"0"))}}function canLog(){return!!company&&-1!=["4wbQLsLgX95Kg6amw_c","pSZJr5kbAY7jEwEtf_c"].indexOf(company._id)}function maximizeChat(){"maximize.chatwidget"!=lastState&&"hide.chatwidget"!=lastState&&(lastState="maximize.chatwidget",popbutton.classList.add("iticks-hidden"),lastMsg.classList.add("iticks-hidden"),containerDiv.classList.remove("iticks-hidden"),chatFrame.contentWindow.postMessage({type:"visibility",data:"WIDGET_MAXIMIZED"},"*"),isMobile&&togglePageScroll(!0))}function minimizeChat(){"minimize.chat"!=lastState&&"hide.chatwidget"!=lastState&&(lastState="minimize.chat",containerDiv.classList.add("iticks-hidden"),popbutton.classList.remove("iticks-hidden"),lastMsg.classList.add("iticks-hidden"),chatFrame.contentWindow.postMessage({type:"visibility",data:"WIDGET_MINIMIZED"},"*"),isMobile&&togglePageScroll(!1))}function showWidget(){"hide.chatwidget"==lastState&&(lastState="show.chatwidget",isWidgetEnabled=!0,containerDiv.classList.add("iticks-hidden"),popbutton.classList.remove("iticks-hidden"),lastMsg.classList.add("iticks-hidden"),chatFrame.contentWindow.postMessage({type:"visibility",data:"WIDGET_MINIMIZED"},"*"),isMobile&&togglePageScroll(!1))}function hideWidget(){"hide.chatwidget"!=lastState&&(isWidgetEnabled=!(lastState="hide.chatwidget"),containerDiv.classList.add("iticks-hidden"),popbutton.classList.add("iticks-hidden"),lastMsg.classList.add("iticks-hidden"),chatFrame.contentWindow.postMessage({type:"visibility",data:"WIDGET_HIDDEN"},"*"),isMobile&&togglePageScroll(!1))}function createOrModifywidgetAppearance(){if(company&&company.livechat_settings){var e=company.livechat_settings,t=20,i=20,n="#006ba7",a="",o="",s=12,d=400,c="#000",r=300,l=350,m=10,p=0,g="right";if(e&&("undefined"!=typeof e.widget_margin_x&&(t=e.widget_margin_x),"undefined"!=typeof e.widget_margin_y&&(i=e.widget_margin_y),o=e.notif_line_height,n=e.color||n,a=e.notif_font_family,s=e.notif_font_size||s,d=e.notif_font_weight||d,c=e.notif_font_color||c,r=e.widget_width||r,l=e.widget_height||l,"undefined"!=typeof e.widget_x&&(m=e.widget_x),p=e.widget_y||p,e.enable_chat_icon_img&&e.chat_icon_img&&chatIcon?(chatIcon.classList.add("agent-img"),chatIcon.src=window.iticks.cdn+"/assets/"+e.chat_icon_img,popbutton&&(popbutton.style.background="transparent")):e.enable_chat_icon_img||(e.color&&popbutton&&(popbutton.style.background=e.color),chatIcon.classList.remove("agent-img"),chatIcon.src=window.iticks.cdn+"/assets/chat_icon.png"),e.widget_position)){var u=e.widget_position.split("_");-1<["left","right"].indexOf(u[1])&&(g=u[1])}var h=document.getElementById("iticks-style__"+company._id);h||(h=document.head.appendChild(document.createElement("style"))).setAttribute("id","iticks-style__"+company._id),h.innerHTML=".iticks-pop-button{bottom:"+i+"px;"+g+":"+t+"px;background:"+n+";}.iticks-badge-container{"+g+": -3px;}.iticks-notif-msg{"+g+":"+(69+t)+"px;bottom:"+i+"px;"+(a?"font-family: "+a+";":"")+(o?"line-height:"+o+"px;":"")+"font-size:"+s+"px;font-weight:"+d+";color:"+c+";}.iticks-last-msg::after{"+g+":-4px}.iticks-frame-container{width:"+r+"px;max-height:"+l+"px;"+g+":"+m+"px;bottom:"+p+"px}@media only screen and (max-device-width: 700px) {.iticks-frame-container {bottom: 0px;left: 0px}}"}}buttonDiv.addEventListener("click",function(){maximizeChat()});var closeTime=getValue("__iticks.closed"),isClosed=!1;closeTime&&Date.now()-parseInt(closeTime)<36e5&&(isClosed=!0),closeBtn.addEventListener("click",function(e){lastMsg.classList.add("iticks-hidden"),e.stopPropagation(),setValue("__iticks.closed",Date.now()),isClosed=!0}),hideWidget();var isFrameReady=!1,isWidgetEnabled=!0;function getCookie(e){var t=("; "+document.cookie).split("; "+e+"=");if(2==t.length)return t.pop().split(";").shift()}var soundTimer=null,notifTimer=null,isTriggerSoundPlayed=!1,company=null;function sendCRMIds(e){if(!(3<e)){var t=getCookie("hubspotutk"),i=!1;if(t&&(chatFrame.contentWindow.postMessage({type:"sethubtk",data:t},"*"),i=!0),window.MXCProspectId&&(chatFrame.contentWindow.postMessage({type:"setls",data:window.MXCProspectId},"*"),i=!0),company&&company.company_settings&&company.company_settings.crm_integration&&-1<company.company_settings.crm_integration.indexOf("GA")){var n=getCookie("_ga");if(n){var a=n.split(".");chatFrame.contentWindow.postMessage({type:"setga",data:a[2]+"."+a[3]},"*"),i=!0}}i||setTimeout(function(){sendCRMIds(e+1)},2e3)}}function sendShopifyCustomer(){window.IticksShopify&&window.IticksShopify.customer&&chatFrame.contentWindow.postMessage({type:"setShopifyUser",data:window.IticksShopify},"*")}function setActivityEvent(){try{window.dispatchEvent(new Event("_iticks.activity"))}catch(e){window.dispatchEvent(function T(t,i){i=i||{bubbles:!1,cancelable:!1,detail:undefined};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,i.bubbles,i.cancelable,i.detail),n}("_iticks.activity",null))}}function receiveMessage(event){if(event.data&&event.data.type)if("set.iticksId"==event.data.type)setValue(event.data.key,event.data.value),onURLChange();else if("activity"==event.data.type)setActivityEvent();else if("theme.set"==event.data.type)popbutton.style.background=event.data.color;else if("minimize.chat"==event.data.type)minimizeChat();else if("maximize.chat"==event.data.type)maximizeChat();else if("show.chatwidget"==event.data.type)company=event.data.company,createOrModifywidgetAppearance(),showWidget();else if("hide.chatwidget"==event.data.type)hideWidget();else if("reset.closebtn"==event.data.type)isClosed=!1;else if("frame.ready"==event.data.type){if(isFrameReady)return;if(isFrameReady=!0,sendCRMIds(0),sendShopifyCustomer(),onNewEvent(),window.iticks.call=function(e,t){if("minimize"==e)minimizeChat();else if("maximize"==e)maximizeChat();else if("hide"==e)hideWidget();else if("show"==e)switch(showWidget(),t){case"minimize":minimizeChat();break;case"maximize":maximizeChat();break;default:minimizeChat()}else chatFrame.contentWindow.postMessage({type:"function",data:{type:e,data:t}},"*")},0<window.iticks.queue.length)for(;0<window.iticks.queue.length;){var item=window.iticks.queue.shift();window.iticks.call(item[0],item[1])}}else if("enable.widget"==event.data.type){if(isWidgetEnabled=!0,company=event.data.company,company&&company.company_settings&&company.company_settings.enable_payment){var h=document.head||document.documentElement,e=document.createElement("script");e.src="https://checkout.razorpay.com/v1/checkout.js",h.insertBefore(e,h.firstChild)}createOrModifywidgetAppearance()}else if("notif"==event.data.type){if(canLog()&&console.log("received notif",event.data,isClosed,soundTimer,lastState),notifTimer&&(clearTimeout(notifTimer),notifTimer=null),"maximize.chatwidget"==lastState||"hide.chatwidget"==lastState)return;var delay=0;event.data.isTriggerMsg&&(delay=1e3*(company.company_settings.engage_wait_time||0)),notifTimer=setTimeout(function(){if(0<event.data.count){if(badgeContainer.style.display="block",unreadCounter.innerText=event.data.count+"",isClosed)return;if(isMobile&&"Hide"==company.livechat_settings.mob_notif_msg)return;if(!isMobile&&"Hide"==company.livechat_settings.web_notif_msg)return;event.data.message?(lastMsgContainer.style.display="block",unreadMessage.innerHTML=event.data.message):lastMsgContainer.style.display="none",lastMsg.classList.remove("iticks-hidden"),soundTimer&&(clearTimeout(soundTimer),soundTimer=null),soundTimer=setTimeout(function(){var e=!1;if(event.data.isTriggerMsg){if(company.livechat_settings.enable_trigger_sound&&!isTriggerSoundPlayed)if("ONCE_PER_SESSION"==company.livechat_settings.trigger_sound_state){var t=getValue(window.iticks.clientId+".lastSoundPlayed");t?Date.now()-parseInt(t)>1e3*parseInt(company.company_settings.disengage_wait)&&(e=!0,setValue(window.iticks.clientId+".lastSoundPlayed",Date.now())):(e=!0,setValue(window.iticks.clientId+".lastSoundPlayed",Date.now()))}else e=!0}else event.data.isBotMsg?company.livechat_settings.enable_bot_msg_sound&&(e=!0):company.livechat_settings.enable_agent_msg_sound&&(e=!0);if(e){var i=new Audio(window.iticks.cdn+"/client/graceful.mp3").play();i&&i.then(function(){canLog()&&console.log("sound played"),event.data.isTriggerMsg&&(isTriggerSoundPlayed=!0)})["catch"](function(e){canLog()&&console.log("sound not played",e)})}},100)}else lastMsg.classList.add("iticks-hidden"),badgeContainer.style.display="none"},delay)}else if("initData"==event.data.type)chatFrame.contentWindow.postMessage({type:"setInitData",data:window.iticks.initData},"*"),chatFrame.contentWindow.postMessage({type:"version",version:version},"*");else if("config.paymentOptions"==event.data.type){var iticksFrame=document.getElementsByClassName("iticks-frame-container").item(0);iticksFrame.style.zIndex="999999999",event.data.options.handler=function(e){chatFrame.contentWindow.postMessage({type:"paymentAuthorized",data:e.razorpay_payment_id,msgId:event.data.msgId},"*"),iticksFrame.style.zIndex="2147483648"},event.data.options.modal={ondismiss:function(e){chatFrame.contentWindow.postMessage({type:"paymentDismiss",msgId:event.data.msgId},"*"),iticksFrame.style.zIndex="2147483648"}},window.rzp=new Razorpay(event.data.options)}else if("show.paymentForm"==event.data.type)window.rzp&&window.rzp.open(),chatFrame.contentWindow.postMessage({type:"paymentInitiate",msgId:event.data.msgId},"*");else if("hide.paymentForm"==event.data.type)window.rzp&&window.rzp.close();else if("set.chatIcon"==event.data.type)chatIcon.src=event.data.chatIcon,chatIcon.classList.add("agent-img"),popbutton.style.background="transparent";else if("execute.javaScript"==event.data.type){if(event.data.code)try{eval(event.data.code)}catch(error){console.log("Error: ",error)}}else"openImage"==event.data.type&&(document.querySelector(".iticks-modal-img").src=event.data.image_url,document.querySelector(".iticks-modal").style.display="flex");else;}var pendingEvents=[];function onNewEvent(){0<pendingEvents.length&&isFrameReady&&chatFrame.contentWindow.postMessage({type:"history",data:pendingEvents.splice(0)},"*")}function recordEvent(e){isWidgetEnabled&&(pendingEvents.push(e),onNewEvent())}recordEvent({type:"Click",url:location.href,time:Date.now()});var isVisible=("undefined"!=typeof document.hidden?(ha="hidden",ia="visibilitychange"):"undefined"!=typeof document.msHidden?(ha="msHidden",ia="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(ha="webkitHidden",ia="webkitvisibilitychange"),"undefined"==typeof document.addEventListener||"undefined"==typeof document[ha]?console.log("IntelliTicks requires a browser, such as Google Chrome or Firefox, that supports the Page Visibility API."):(document.addEventListener(ia,ka,!1),window.addEventListener("hashchange",ka,!1)),document[ha]?(ja=!1,recordEvent({type:"Hide",url:location.href,time:Date.now()+1})):(ja=!0,recordEvent({type:"Show",url:location.href,time:Date.now()+1})),na(),window.addEventListener("mousemove",na,!1),window.addEventListener("mousedown",na,!1),window.addEventListener("keypress",na,!1),window.addEventListener("DOMMouseScroll",na,!1),window.addEventListener("mousewheel",na,!1),window.addEventListener("touchmove",na,!1),window.addEventListener("MSPointerMove",na,!1),window.addEventListener("_iticks.activity",na,!1),function(){return ja}),ha,ia,ja,la;function ka(){(ja=!document[ha])&&na(),recordEvent({type:ja?"Show":"Hide",time:Date.now(),url:location.href})}function na(){ja||recordEvent({type:"Show",url:location.href,time:Date.now()}),ja=!0,function e(){la&&window.clearTimeout(la),la=window.setTimeout(function(){ja=!1,recordEvent({type:"Hide",url:location.href,time:Date.now()+1})},3e4)}()}function onURLChange(){chatFrame.contentWindow.postMessage({type:"url.change",data:{url:window.location.href}},"*")}!function(s){function e(o){return function(e,t,i){var n=c[o].apply(s,arguments);onURLChange();var a=Date.now();return isVisible()||recordEvent({type:"Hide",url:d,time:a}),recordEvent({type:"Click",url:location.href,time:a+1}),isVisible()||recordEvent({type:"Show",url:location.href,time:a+2}),d=location.href,n}}var d=location.href,c={pushState:s.pushState,replaceState:s.replaceState,noop:function(){}};for(field in c)s[field]=e(field);window.addEventListener("popstate",c.noop)}(window.history),window.addEventListener("message",receiveMessage,!1)}"interactive"==document.readyState||"complete"==document.readyState?setup():document.addEventListener?document.addEventListener("readystatechange",function(){"interactive"==document.readyState&&setup()}):document.attachEvent&&document.attachEvent("readystatechange",function(){"interactive"==document.readyState&&setup()})}(window,document);
